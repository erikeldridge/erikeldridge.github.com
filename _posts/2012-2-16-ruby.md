---
layout: post
title: Ruby toolkit
---

* toc
{:toc}

## Gems

* List gems w/ details: `gem list -d`
* Install gem w/o docs: `gem install <gem name> --no-rdoc --no-ri`

### Handy gems

* YAJL for JSON parsing: [https://github.com/brianmario/yajl-ruby](https://github.com/brianmario/yajl-ruby)
* Bundler for dependency management: [http://gembundler.com/](http://gembundler.com/)
* Dalli for memcached: [https://github.com/mperham/dalli](https://github.com/mperham/dalli)

### Bundler

* Bundler uses the gem sources listed in the Gemfile, not necessarily those listed in `gem sources`

## Regex

* Match (returns start index of match. Note: 0 is truthy): `'foo' =~ /foo/`
* Not match: `'foo' !~ /bar/`

## RVM

See [RVM learnings post](/2011/11/28/rvm-learnings.md).

## Rake

* `rake -T` to show all rake tasks
* `rake <task> --trace` to show rake stack trace on error

## Spec

* Run spec w/ `-c` option for satisfying red/green output

## Rails security

* [Brakeman](http://brakemanscanner.org/) static analysis tool

## Rails testing

* [Flavio Castelli](http://flavio.castelli.name/rails_execute_single_test) documents how to run a single file: `ruby -I"lib:test" test/unit/{path to test}.rb`
* And how to run a single test identified by a regex: `ruby -I"lib:test" test/unit/invitation_test.rb -n /fn_name/`
* Run a specific test  w/ rdebug: `rdebug test/unit/blah.rb -- -n /my_test_name/`. Note: "-- marks the end of the arguments to rdebug, and the beginning of the args to the file it runs" - [@mattknox](http://twitter.com/mattknox)

## Rails debugging

### Misc

* `reload!` to reload a rails app running via script/console
* Handy print statement: `require 'pp'; pp __FILE__, __LINE__, bucket, '='*50`
* [Ruby debug reference](http://bashdb.sourceforge.net/ruby-debug.html)
* [Rails debugging reference](http://guides.rubyonrails.org/debugging_rails_applications.html#step-by-step)
* Install ruby-debug given bundler gem management: `alias add_rdebug='echo gem \"ruby-debug\" >>Gemfile; bundle'`
* Uninstall ruby-debug given bundler: `alias remove_rdebug='grep -v ruby-debug Gemfile >Gemfile; bundle'`

### .rdebugrc

Create a file called _~/.rdebugrc_ and add the following:

    set autolist
    set autoeval
    set autoreload

Directory-specific _.rdebugrc_ files can be also be defined.

### Where am I?

* `list, l` to see next ten lines of context
* `list-, l-` to see the previous ten lines of context
* `list=, l=` to see the current context
* `set autolist` (in _~/.rdebugrc_) to see context automatically

### How did I get here?

* `backtrace, bt, where` to see the call stack
* `frame {n}` to inspect a specific call in the stack
* `up`/`down` to move up/down the call stack

### Stepping into and over

* `step, s` to step into
* `next, n, ‚èé` to step out/over

### Breakpoints

* `break {n}, b {n}` to set a breakpoint at a specific line number (use `list` to see line numbers)
* `break {path}:{n}` to set a breakpoint at a specific line number in a file
* `info break, info b` to show breakpoints
* `continue, c` to continue to the next breakpoint

### What's that?

* `e, p` to print the value of a variable
* `pp` to pretty-print a variable
* `irb` to start an irb session (`quit` to exit the session)

## Closing pic

![Ruby-spotted Swallowtail (Papilio anchisiades), by Anne Toal](http://farm3.staticflickr.com/2292/2046175430_3651a95e1b.jpg)

[Ruby-spotted Swallowtail (Papilio anchisiades), by Anne Toal](http://www.flickr.com/photos/annetoal/2046175430/)
